---
import Layout from "../../layouts/Layout.astro";
import ContentReveal from "../../components/ui/ContentReveal.astro";
import BackButton from "../../components/ui/BackButton.astro";

// Define the playlist data
const playlistData = [
  {
    id: "ovQkVCCZ4VA?start=50",
    title: "The Forever Story",
    artist: "JID"
  },
  {
    id: "xdGPVlVKwhI",
    title: "Flowers For My Father", 
    artist: "Sadistik"
  },
  {
    id: "dQw4w9WgXcQ",
    title: "Example Album 3",
    artist: "Artist 3"
  }
];

// Get the video ID from query params
const url = new URL(Astro.request.url);
const videoId = url.searchParams.get('v') || playlistData[0].id;

// Find current track info
const currentTrack = playlistData.find(track => track.id === videoId) || playlistData[0];
---

<Layout title="Hip-Hop Albums">
  <ContentReveal id="hiphopContent" class="content">
    <div class="page-container">
      <BackButton href="/music" text="Back to Music" />
      
      (wip - 19Aug25)

      <header class="page-header">
        <h1 class="page-title">Hip-Hop Albums</h1>
      </header>

      <!-- Current Track Info -->
      <div class="current-track-info">
        <h2>Now Playing: {currentTrack.title}</h2>
        <p>by {currentTrack.artist}</p>
      </div>

      <!-- Single Video Container -->
      <div class="video-container">
        <iframe 
          width="100%" 
          height="315" 
          src={`https://www.youtube.com/embed/${videoId}`}
          title={`${currentTrack.title} - ${currentTrack.artist}`}
          frameborder="0" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
          allowfullscreen>
        </iframe>
      </div>

      <div class="content-section">
        <p>i've liked hiphop since i was a yung lad. here's a mix of albums.</p>
      </div>

      <!-- Randomizer Button -->
      <div class="randomizer-section">
        <button id="randomizeBtn" class="randomize-btn">
          <span class="shuffle-icon">ðŸ”€</span>
          Shuffle Track
        </button>
      </div>

      <div class="playlist-section">
        <h2>Playlist</h2>
        <div class="playlist-items">
          {playlistData.map((track) => (
            <a 
              href={`/music/hiphop-albums?v=${track.id}`} 
              class={`playlist-item ${track.id === videoId ? 'active' : ''}`}
            >
              <div class="playlist-star">â™ª</div>
              <div class="playlist-content">
                <h3>{track.title}</h3>
                <p>{track.artist}</p>
              </div>
              <div class="play-status">â–¶</div>
            </a>
          ))}
        </div>
      </div>
    </div>
  </ContentReveal>
</Layout>

<style>
  .page-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .page-header {
    margin-bottom: 2rem;
  }

  .page-title {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, var(--cyber-accent), var(--cyber-secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .video-container {
    width: 100%;
    margin-bottom: 2rem;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  }

  .current-track-info {
    text-align: center;
    margin-bottom: 2rem;
    padding: 1rem;
    background: var(--cyber-bg-secondary);
    border: 1px solid var(--cyber-border);
    border-radius: 8px;
  }

  .current-track-info h2 {
    margin: 0 0 0.5rem 0;
    color: var(--cyber-accent);
    font-size: 1.25rem;
  }

  .current-track-info p {
    margin: 0;
    color: var(--cyber-text-secondary);
    font-size: 1rem;
  }

  .video-container iframe {
    aspect-ratio: 16 / 9;
    border: none;
  }

  .randomizer-section {
    display: flex;
    justify-content: center;
    margin: 2rem 0;
  }

  .randomize-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, #ff6b35, #ff8a50);
    color: white;
    border: none;
    border-radius: 25px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
  }

  .randomize-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
    background: linear-gradient(135deg, #ff8a50, #ff6b35);
  }

  .randomize-btn:active {
    transform: translateY(0);
  }

  .shuffle-icon {
    font-size: 1.1rem;
    animation: shuffle 0.5s ease-in-out;
  }

  @keyframes shuffle {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(180deg); }
  }

  .content-section {
    margin-bottom: 3rem;
    padding: 1.5rem;
    background: var(--cyber-bg-secondary);
    border: 1px solid var(--cyber-border);
    border-radius: 8px;
  }

  .playlist-section {
    margin-bottom: 2rem;
  }

  .playlist-section h2 {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    color: var(--cyber-accent);
  }

  .playlist-items {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .playlist-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    background: var(--cyber-bg-secondary);
    border: 1px solid var(--cyber-border);
    border-radius: 8px;
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    text-decoration: none;
    color: inherit;
  }

  .playlist-item:hover {
    border-color: var(--cyber-accent);
    background: var(--cyber-bg-tertiary);
    transform: translateX(4px);
    text-decoration: none;
    color: inherit;
  }

  .playlist-item.active {
    border-color: #ff6b35;
    background: var(--cyber-bg-tertiary);
    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.3);
  }

  .playlist-star {
    width: 40px;
    height: 40px;
    background: #ff6b35;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    font-size: 1.2rem;
  }

  .playlist-content {
    flex: 1;
  }

  .playlist-content h3 {
    margin: 0 0 0.25rem 0;
    font-size: 1.1rem;
    color: var(--cyber-text-primary);
  }

  .playlist-content p {
    margin: 0;
    color: var(--cyber-text-secondary);
    font-size: 0.9rem;
  }

  .play-status {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: var(--cyber-accent);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    opacity: 0.7;
    transition: all 0.3s ease;
  }

  .playlist-item.active .play-status {
    background: #ff6b35;
    opacity: 1;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.6; }
    100% { opacity: 1; }
  }

  @media (max-width: 768px) {
    .page-title {
      font-size: 2rem;
    }
    
    .video-container {
      margin-bottom: 1.5rem;
    }
    
    .content-section {
      padding: 1rem;
    }
  }
</style>

<script define:vars={{ playlistData }}>
  // Randomizer functionality
  function initializeRandomizer() {
    const randomizeBtn = document.getElementById('randomizeBtn');
    
    if (randomizeBtn) {
      randomizeBtn.addEventListener('click', () => {
        // Get random track
        const randomIndex = Math.floor(Math.random() * playlistData.length);
        const randomTrack = playlistData[randomIndex];
        
        // Navigate to random track
        window.location.href = `/music/hiphop-albums?v=${randomTrack.id}`;
      });
    }
  }

  // Initialize when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    initializeRandomizer();
  });

  // Reinitialize for Astro's View Transitions
  document.addEventListener('astro:page-load', () => {
    initializeRandomizer();
  });
</script>