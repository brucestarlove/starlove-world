---
import Layout from "../layouts/Layout.astro";
import ContentReveal from "../components/ui/ContentReveal.astro";
import CyclingLogo from "../components/CyclingLogo.astro";
import SocialLinks from "../components/SocialLinks.astro";
import LampTooltip from "../components/LampTooltip.astro";
import { getCollection } from "astro:content";

const projects = await getCollection("projects");
const projectsByCategory = projects.reduce(
  (acc, project) => {
    const category = project.data.category;
    if (!acc[category]) {
      acc[category] = [];
    }
    acc[category].push(project);
    return acc;
  },
  {} as Record<string, typeof projects>
);

const categories = Object.keys(projectsByCategory);
---

<Layout title="About">
  <ContentReveal id="aboutContent" class="content">
    <header class="hero">
      <div class="hero-header">
        <div class="title-row">
          <CyclingLogo />
          <h1 class="hero-title animate-title-delayed" id="heroTitle">
            a lil about me
          </h1>
        </div>
        <div class="hero-content animate-content-slow" id="heroContent">
          <div class="hero-text">
            <p>
              hello and good tidings. my name is Bruce. i like a lot of things.
              i want to do a lot of things. i've been assisting various small
              businesses & nonprofit orgs, playing around with AI tools and
              blockchain games, thinking about optimistic solutions, dreaming of
              decentralized potentials, attending events and meeting people,
              learning piano and salsa, learning spanish and hindi, catsitting
              in NYC, exploring life, enjoying hobbies, making some arts, foolin
              around with <strong id="lampWord" class="lamp-trigger"
                >stuff</strong
              >, healing my psyche, learning to lead, hoping for better, praying
              for peace //
            </p>
            <p>—☆♡</p>
          </div>

          <SocialLinks />
        </div>
      </div>
    </header>

    <div class="sections animate-content-medium">
      {
        categories.map((category, categoryIndex) => (
          <div class="section animate-slideup" style={`animation-delay: ${0.8 + categoryIndex * 0.2}s`}>
            <h2 class="section-title animate-title-delayed">{category}</h2>
            <div class="posts-list">
              {projectsByCategory[category].map((project, projectIndex) => (
                <article
                  class="post-item animate-content-fast"
                  style={`--post-color: ${project.data.color}; animation-delay: ${1.2 + categoryIndex * 0.2 + projectIndex * 0.1}s`}
                  data-category={category.toLowerCase()}
                  data-title={project.data.title.toLowerCase()}
                  data-description={project.data.description.toLowerCase()}
                >
                  <a href={`/projects/${project.slug}`} class="item-link">
                    <div
                      class="item-star"
                      style={`background-color: ${project.data.color}`}
                    >
                      ★
                    </div>
                    <div class="item-content">
                      <h3 class="item-title">{project.data.title}</h3>
                    </div>
                  </a>
                </article>
              ))}
            </div>
          </div>
        ))
      }
    </div>

    <LampTooltip />
  </ContentReveal>
</Layout>
